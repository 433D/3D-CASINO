<!DOCTYPE html>
<html>
<head>
  <title>人間競馬 管理</title>
  <script>
    function submitResult() {
      // 勝者と配当を取得
      var winner = document.getElementById("winner").value;
      var dividendRate = document.getElementById("dividendRate").value;

      // 入力値のバリデーション (必要に応じて追加)

      // Google Apps Script の関数を実行
      google.script.run
        .withSuccessHandler(showResult)
        .withFailureHandler(showError) // エラーハンドラを追加
        .calculateDividend(winner, dividendRate, 'https://script.google.com/macros/s/AKfycbwZwNeRB9lRxy-fNGXf5gevLHyjNdB1ErpwHoOJFUS-ByI8PkRbmj1dY-ZR0AyBCe-isw/exec'); // URLを追加
    }

    function showResult(message) {
      alert(message);
    }

    function showError(error) {
      console.error("Error:", error);
      alert("エラーが発生しました: " + error);
    }
  </script>
</head>
<body>
  <h1>人間競馬 管理</h1>
  勝者 (A, B, C, D): <input type="text" id="winner"><br>
  配当倍率: <input type="number" id="dividendRate"><br>
  <button onclick="submitResult()">結果入力</button>
</body>
</html>