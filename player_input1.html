<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>プレイヤー入力ページ</title>
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 500px;
            margin: 0 auto;
            padding: 20px;
        }
        form {
            display: flex;
            flex-direction: column;
        }
        label {
            margin-top: 10px;
        }
        input, select {
            margin-bottom: 10px;
            padding: 5px;
        }
        button {
            margin-top: 10px;
            padding: 10px;
            background-color: #4CAF50;
            color: white;
            border: none;
            cursor: pointer;
        }
        button:hover {
            background-color: #45a049;
        }
        #message {
            margin-top: 20px;
            padding: 10px;
            border-radius: 5px;
        }
        .success {
            background-color: #d4edda;
            color: #155724;
        }
        .error {
            background-color: #f8d7da;
            color: #721c24;
        }
    </style>
</head>
<body>
    <h1>賭け情報入力</h1>
    <form id="betForm">
        <label for="playerId">プレイヤーID:</label>
        <input type="text" id="playerId" required>

        <label for="betTarget">賭けの対象:</label>
        <select id="betTarget" required>
            <option value="">選択してください</option>
            <option value="Aさん">Aさん</option>
            <option value="Bさん">Bさん</option>
            <option value="Cさん">Cさん</option>
            <option value="Dさん">Dさん</option>
        </select>

        <label for="betAmount">賭け金額:</label>
        <input type="number" id="betAmount" required min="1">

        <button type="submit">送信</button>
    </form>

    <div id="message"></div>

    <script>
        // SupabaseのURLとAPIキーを設定します
        const supabaseUrl = 'https://nvxdgqdxyzjpotxjuwhx.supabase.co';
        const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im52eGRncWR4eXpqcG90eGp1d2h4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3MjUwNzczNDMsImV4cCI6MjA0MDY1MzM0M30.3iyzaavXPkN0mGhfA4vJC9t1oijI3Qe-nVGMfPzjS-s';

        // Supabaseクライアントの初期化
        const supabase = supabase.createClient(supabaseUrl, supabaseKey);

        // フォームの送信処理
        document.getElementById('betForm').addEventListener('submit', async function(e) {
            e.preventDefault(); // デフォルトのフォーム送信を防止
            const messageDiv = document.getElementById('message');
            messageDiv.innerHTML = '';
            messageDiv.className = '';

            // 入力値の取得
            const playerId = document.getElementById('playerId').value;
            const betTarget = document.getElementById('betTarget').value;
            const betAmount = parseInt(document.getElementById('betAmount').value);

            try {
                // データの挿入
                const { data, error } = await supabase
                    .from('bets')
                    .insert([
                        { player_id: playerId, bet_target: betTarget, bet_amount: betAmount }
                    ]);

                // エラーハンドリング
                if (error) throw error;

                // 成功メッセージの表示
                messageDiv.textContent = '賭け情報が正常に送信されました！';
                messageDiv.className = 'success';
                this.reset(); // フォームのリセット
            } catch (error) {
                console.error('Error inserting data:', error);
                messageDiv.textContent = 'エラーが発生しました。もう一度お試しください。';
                messageDiv.className = 'error';
            }
        });
    </script>
</body>
</html>
