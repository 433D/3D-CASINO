<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>賭け情報入力</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        input, select, button { margin: 10px 0; padding: 10px; width: 100%; max-width: 300px; }
        button { background-color: #007BFF; color: white; border: none; cursor: pointer; }
        button:hover { background-color: #0056b3; }
    </style>
</head>
<body>
    <h1>賭け情報入力</h1>
    <form id="betForm">
        <label for="player_id">プレイヤーID:</label>
        <input type="text" id="player_id" required>

        <label for="player_name">プレイヤー名:</label>
        <input type="text" id="player_name" readonly>

        <label for="balance">所持金:</label>
        <input type="text" id="balance" readonly>

        <label for="horse">賭け先:</label>
        <select id="horse" required>
            <option value="Aさん">Aさん</option>
            <option value="Bさん">Bさん</option>
            <option value="Cさん">Cさん</option>
            <option value="Dさん">Dさん</option>
        </select>

        <label for="amount">賭け金額:</label>
        <input type="number" id="amount" step="1000" required>

        <button type="submit">賭ける</button>
    </form>

    <script>
        const SPREADSHEET_URL = 'https://docs.google.com/forms/d/e/FORM_ID/formResponse'; // Google FormsのURLに変更

        document.getElementById('player_id').addEventListener('input', function() {
            const playerId = this.value;
            fetch(SPREADSHEET_URL)
                .then(response => response.text())
                .then(data => {
                    const jsonData = JSON.parse(data.substr(47).slice(0, -2));
                    const rows = jsonData.table.rows;
                    const player = rows.find(row => row.c[0].v == playerId);
                    if (player) {
                        document.getElementById('player_name').value = player.c[1].v;
                        document.getElementById('balance').value = player.c[2].v;
                    } else {
                        document.getElementById('player_name').value = '';
                        document.getElementById('balance').value = '';
                    }
                })
                .catch(error => console.error('Error fetching player data:', error));
        });

        document.getElementById('betForm').addEventListener('submit', function(event) {
            event.preventDefault();

            const playerId = document.getElementById('player_id').value;
            const horse = document.getElementById('horse').value;
            const amount = parseInt(document.getElementById('amount').value);
            const balance = parseInt(document.getElementById('balance').value);

            if (amount > balance || amount % 1000 !== 0) {
                alert('賭け金額は所持金以内かつ1000円単位で入力してください。');
                return;
            }

            // Google Formsにデータを送信
            const formData = new FormData();
            formData.append('entry.1234567890', playerId);  // フォーム項目に合わせて変更
            formData.append('entry.0987654321', horse);
            formData.append('entry.1122334455', amount);

            fetch(SPREADSHEET_URL, {
                method: 'POST',
                mode: 'no-cors',
                body: formData
            })
            .then(() => alert('賭け情報が送信されました！'))
            .catch(error => console.error('Error submitting bet data:', error));
        });
    </script>
</body>
</html>
