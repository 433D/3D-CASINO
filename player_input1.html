<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>賭け入力フォーム</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
</head>
<body>
    <h1>賭けの入力フォーム</h1>
    <form id="betForm">
        <label for="playerId">プレイヤーID:</label>
        <input type="text" id="playerId" name="playerId" required><br><br>

        <label for="betTarget">賭けの対象:</label>
        <select id="betTarget" name="betTarget" required>
            <option value="" disabled selected>選択してください</option>
            <option value="Aさん">Aさん</option>
            <option value="Bさん">Bさん</option>
            <option value="Cさん">Cさん</option>
            <option value="Dさん">Dさん</option>
        </select><br><br>

        <label for="betAmount">賭け金額:</label>
        <input type="number" id="betAmount" name="betAmount" min="1" required><br><br>

        <button type="button" id="submitButton">送信</button>
    </form>

    <script>
        // SupabaseのURLとAPIキーを設定します
        const SUPABASE_URL = 'https://nvxdgqdxyzjpotxjuwhx.supabase.co'; // あなたのSupabaseのプロジェクトURL
        const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im52eGRncWR4eXpqcG90eGp1d2h4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3MjUwNzczNDMsImV4cCI6MjA0MDY1MzM0M30.3iyzaavXPkN0mGhfA4vJC9t1oijI3Qe-nVGMfPzjS-s'; // あなたのSupabaseのanonキー
        const supabase = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

        // データを送信する関数
        async function submitBet() {
            const playerId = document.getElementById('playerId').value; // プレイヤーID
            const betTarget = document.getElementById('betTarget').value; // 賭けの対象
            const betAmount = parseInt(document.getElementById('betAmount').value); // 賭け金額

            console.log('送信データ:', { playerId, betTarget, betAmount }); // デバッグ用ログ

            try {
                const { data, error } = await supabase
                    .from('bets') // テーブル名 'bets'
                    .insert([{ 
                        player_id: playerId,  // プレイヤーIDを player_id カラムに送信
                        bet_target: betTarget,  // 賭けの対象を bet_target カラムに送信
                        bet_amount: betAmount  // 賭け金額を bet_amount カラムに送信
                    }]);

                if (error) {
                    console.error('エラー:', error);
                    alert('データの送信中にエラーが発生しました');
                } else {
                    alert('賭けが送信されました');
                    document.getElementById('betForm').reset(); // フォームをリセット
                }
            } catch (err) {
                console.error('予期しないエラー:', err);
                alert('予期しないエラーが発生しました。コンソールを確認してください。');
            }
        }

        // 送信ボタンのクリックイベントリスナーを設定
        document.getElementById('submitButton').addEventListener('click', submitBet);
    </script>
</body>
</html>
